{% extends "base.html" %}

{% load static %}




      {% block head_title %}
        <title> Dashboard </title>
      {% endblock %}

      <meta name="description" content="Site dashboard.">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      {% block css_links %}
        <link rel="stylesheet" type="text/css" href="{% static 'dashboard/css/style.css' %}">

        <!-- Font awesome cdn so we can use their icons. -->
        <script src="https://kit.fontawesome.com/6cf6986f3d.js" crossorigin="anonymous"></script>


        <!-- Leaflet css -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />

      {% endblock %}
  

  {% block content %}

  <!-- USE .no-gutters to REMOVE SPACE BETWEEN COLUMNS-->
  <div class= "container-fluid">
    <div class="row">
      <!-- In boot strap grid, you can have a maximum of 12 columns total, col-11 means user all 11 columns spaces avaialble, leaving only one column space for the remaining columns.-->
      <div class="col-10">
        <div class= "container-fluid">
          <div class="row" >
            <div class="col">


              <div class="d-flex flex-row">
                <h4 id="appl-filters-display"> Applied Filters: None</h4>

                <div class="display-filters-container">

                </div>

              </div>

              <div class="form-floating mt-3 mb-1 d-flex flex-row flex-nowrap">
                <form id="user-search-box-form" class="form-floating w-100" method="post">
                   <!-- Protects against Cross Site Request Forgeries. YOUR FORM WONT WORK WITHOUT THIS TOKEN INSIDE THE FORM.-->
                  {% csrf_token %}


                  <!-- This is where the json from our django backend is stored until a javascript function grabs the data to search through it. -->
                  <input id="client-json-input" type="hidden" value="{{client_json}}"></input>

                  <input type="text" class="form-control border border-primary rounded flex-grow-1" id="user-search-input" placeholder="Type your search here!">

                  <label id="search-input-label" for="user-search-input"> Search: </label>
                </form>

                  <div id="filter-container" class="container">
                    <div class="row px-3">
                      <div class="col px-1 d-flex justify-content-center">
                        <h4> Filters </h4>
                      </div>
                    </div>

                    <div class="row  px-3">
                      <div class="col-4 d-flex flex-column px-1">
                        <h5 class="filter-pattern-category" >City</h5>

                        <div>
                          <!-- query key tells us what keys to match the query pattern too. For example if the user clicks this check box, we search our entire list of clients, but only return clients who are in mesa.-->
                          <input id="mesa-filter-pattern" type="checkbox" data-query-key="city" data-query-pattern="mesa">
                          <label for="mesa-filter-pattern"> - Mesa </label>
                        </div>

                        <div>
                          <input id="phoenix-filter-pattern" type="checkbox" data-query-key="city" data-query-pattern="phoenix" >
                          <label for="phoenix-filter-pattern" > - Phoenix </label>
                        </div>

                        <div>
                          <input id="scottsdale-filter-pattern" type="checkbox" data-query-key="city" data-query-pattern="scottsdale">
                          <label for="scottsdale-filter-pattern" > - Scottsdale </label>
                        </div>

                        <div>
                          <input id="flagstaff-filter-pattern" type="checkbox" data-query-key="city" data-query-pattern="flagstaff">
                          <label for="flagstaff-filter-pattern" > - Flagstaff </label>
                        </div>

                      </div>

                      <div class="col-4 d-flex flex-column px-1">
                        <h5 class="filter-pattern-category" >Policies</h5>

                        <div>
                          <!-- query key tells us what keys to match the query pattern too. For example if the user clicks this check box, we search our entire list of clients, but only return clients who are in mesa.-->
                          <input id="fire-filter-pattern" type="checkbox" data-query-key="policies" data-query-pattern="fire">
                          <label for="fire-filter-pattern"> - Fire </label>
                        </div>

                        <div>
                          <input id="home-filter-pattern" type="checkbox" data-query-key="policies" data-query-pattern="home" >
                          <label for="home-filter-pattern" > - Home </label>
                        </div>

                        <div>
                          <input id="pet-filter-pattern" type="checkbox" data-query-key="policies" data-query-pattern="pet">
                          <label for="pet-filter-pattern" > - Pet </label>
                        </div>

                        <div>
                          <input id="boat-filter-pattern" type="checkbox" data-query-key="policies" data-query-pattern="boat">
                          <label for="boat-filter-pattern" > - Boat </label>
                        </div>

                        <div>
                          <input id="auto-filter-pattern" type="checkbox" data-query-key="policies" data-query-pattern="auto">
                          <label for="auto-filter-pattern" > - Auto </label>
                        </div>

                      </div>




                      <div class="col-4 d-flex flex-column px-1">
                        <h5 class="filter-range-pattern-category" data-is-range="true" >Age</h5>

                        <div> Enter Range </div>
                        <div>
                          <input id="age-filter-range-pattern-1" class="age-filter-input" type="text" data-query-key="age" data-query-pattern="lower-range" placeholder="Min">
                          <span> - </span>
                          <input id="age-filter-range-pattern-2" class="age-filter-input" type="text" data-query-pattern="upper-range" placeholder="Max" >
                        </div>
                      </div>


                    </div>

                    <div class="row">
                      <div class="col d-flex flex-row-reverse">
                        <button type="button" id="clear-filters-btn" class="btn btn-danger"> Clear All Filters </button>
                      </div>
                    </div>


                  </div>


                </div>

            </div>
          </div>


          <div class="row">
            <!-- Map needs to be inside a NON FLEX box element inorder to change the width. -->
            <div >
              <div class="col" id="client-map">
                Map Section
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col">

              <div>

                <ul class="nav nav-tabs py-2 my-2" id="myTab" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true" disabled>
                      Search Results:
                    </button>
                  </li>
                </ul>

                <div class="bootstrap-grey-border pb-2 sr-scroll-box" id="search-results-container">


                </div>

                <div class="float-end">
                  <button type="button" id="expand-sr-btn" class="btn btn-primary">Expand Search Results</button>
                </div>

              </div>

            </div>
          </div>

          <div class="row">
            <div class="col">
              <div id="notif-container" class="my-3">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Notifications</button>
                  </li>
                </ul>

                <div class="tab-content" id="myTabContent">

                  <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">

                    <h4> Send Message</h4>

                    <div id="notif-tab-1" class="notif-tab px-3 py-3">

                      <div class="d-flex flex-row justify-content-between">
                        <div class="w-50">

                            <div>
                              <label for="message-subject"> Subject: </label>
                              <input id="message-subject" class="form-control" type="subject" name="subject">
                            </div>

                            <div>
                              <label for="message-body"> Message: </label>
                              <textarea id="message-body" class="form-control" type="text-area" name="message">  </textarea>
                            </div>
                        </div>

                        <div>

                          <label for="sel-msg-type"> Message Type: </label>
                          <select id="sel-msg-type" class="form-select mb-2" aria-label="Select message type">
                            <option value="def-select-opt" selected> Select a Message Type </option>
                              <option value="send-sms"> Send SMS </option>
                              <option value="send-email">Send Email </option>
                              <option value="send-both">Send Email and SMS </option>
                          </select>

                          <label for="sel-msg-priority"> Message Priority: </label>
                          <select id="sel-msg-priority" class="form-select" aria-label="Select message priority">
                            <option value="def-select-opt" selected> Select a Message Priority </option>
                              <option value="send-emergency"> Send Emergency Message</option>
                              <option value="send-social">Send Social Message</option>
                          </select>

                        </div>

                      </div>

                      <div class="d-flex flex-row-reverse">
                        <button id="send-msg" class="btn btn-primary"> Send Message </button>
                      </div>

                      <h3> Selected Clients </h3>
                      <div id="selected-clients-container">
                        <input id="selected-clients-id-array" type="hidden">
                      </div>

                    </div>
                  </div>


                </div>



              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- This col is going to be really small because it only gets 1 column space out of the 12 available in this row.-->
      <div class="col-2 px-0">
        <div class= "container-fluid px-0">
          <div class="row" >
            <div class="col">


              <div class="box-with-header mb-5">
                <div class="bwh-header d-flex justify-content-center px-1 py-1">
                  <h4> Saved Searches</h4>
                </div>

                <div class="bwh-content px-2 pb-2">
                  <ul class="list-group">
                    <li class="list-group-item">An active item</li>
                    <li class="list-group-item">A second item</li>
                    <li class="list-group-item">A third item</li>
                    <li class="list-group-item">A fourth item</li>
                    <li class="list-group-item">And a fifth one</li>
                  </ul>
                </div>
              </div>

            </div>

          </div>

          <div class="row" >
            <div class="col">

               <div class="box-with-header">
                <div class="bwh-header d-flex justify-content-center px-1 py-1">
                  <h4> Saved Subsets</h4>
                </div>

                <div class="bwh-content px-2 pb-2">
                  <ul class="list-group">
                    <li class="list-group-item">An active item</li>
                    <li class="list-group-item">A second item</li>
                    <li class="list-group-item">A third item</li>
                    <li class="list-group-item">A fourth item</li>
                    <li class="list-group-item">And a fifth one</li>
                  </ul>
                </div>
              </div>

            </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>



  <a href='/tech_demo/send_email'></a>

  {% endblock %}





  {% block js_links %}

    <script src="{% static 'dashboard/js/dashboard.js' %}" >  </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin="anonymous"></script>
    
    <!-- Map js scripts -->
    <script src="{% static 'dashboard/js/map.js' %}"></script>
    <script src="{% static 'dashboard/js/pointinpoly.js' %}"></script>

  {% endblock %}
